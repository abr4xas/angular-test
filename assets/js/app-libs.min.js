/**
 * angular-test - Prueba básica de AngularJS usando las guías de estilo de John Papa con JSONPlaceholder
 * @author Angel Cruz <me@abr4xas.org> (http://abr4xas.org)
 * @version v1.0.2
 * @link 
 */

(function () {
    'use strict';
    angular
        .module('cfapp', ['ui.router','ngResource','apiRest']);
})();
(function () {
    'use strict';
    angular
        .module('apiRest', [])
        .factory('GetPostFactory', GetPostService)
        .factory('GetPostDetailFactory', GetPostDetailService)
        .factory('GetCommentsFactory', GetCommentsService);

    GetPostService.$injector = ['$resource'];
    GetPostDetailService.$injector = ['$resource'];
    GetCommentsService.$injector = ['$resource'];

    function GetPostService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts');
    }
    // Detalles de la publicacion
    function GetPostDetailService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts/:id', {
            id: '@id'
        });
    }
    
    // Comentarios de la publicacion
    function GetCommentsService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts/:id/comments', {
            id: '@id'
        });
    }
    
})();
(function () {
    'use strict';
    angular
        .module('cfapp')
        .controller('postCtrl', Post)
        .controller('detailCtrl', Detail)
        .controller('commentsCtrl', Comments);

    Post.$inject = ['GetPostFactory'];
    Detail.$inject = ['GetPostDetailFactory', '$stateParams'];
    Comments.$inject = ['GetCommentsFactory', '$stateParams'];

    function Post(GetPostFactory) {
        var vm = this;
        vm.entries = [];
        vm.loading = true;
        execute();
        function execute() {
            return new ObtenerPost();
        }
        function ObtenerPost() {
            return GetPostFactory.query(function (data) {
                vm.entries = data;
                //console.log(data);
                vm.entries;
                vm.loading = false;
            }, function (e) {
                vm.loading = false;
            }); // regresa todas las publicaciones
        }
    } // End Post

    function Detail(GetPostDetailService, $stateParams) {
        var vm = this;
        vm.entry;
        vm.id = $stateParams.id;
        vm.loading = true;
        execute();
        function execute() {
            return new ObtenerPostDetalle();
        }
        function ObtenerPostDetalle() {
            return GetPostDetailService.get({ id: vm.id }, function (data) {
                vm.entry = data;
                //console.log(data);
                vm.entry;
                vm.loading = false;
            }, function (e) {
                vm.loading = false;
            }); // regresa contenido del post
        }
    } // End Detail

    function Comments(GetCommentsFactory, $stateParams) {
        var vm = this;
        vm.comment;
        vm.id = $stateParams.id;
        vm.loading = true;
        execute();
        function execute() {
            return new ObtenerComentarios();
        }
        function ObtenerComentarios() {
            return GetCommentsFactory.query({ id: vm.id }, function (data) {
                vm.comment = data;
                //console.log(data);
                vm.comment;
                vm.loading = false;
            }, function (e) {
                vm.loading = false;
            }); // regresa los comentarios relacionados al post
        }

    } // End Comments

})();
(function () {
    'use strict';
    angular
        .module('cfapp')
        .config(routes)
        .run(removerCache);

    // Inyectando dependencias.
    routes.$inject = ['$stateProvider', '$urlRouterProvider', '$locationProvider'];
    /**
     * @description gestiona las rutas de la aplicación.
     * @param $stateProvider
     * @param $urlRouterProvider
     */
    function routes($stateProvider, $urlRouterProvider, $locationProvider) {
        $urlRouterProvider.otherwise('/');
        $stateProvider
            .state('home', {
                url: '/',
                controller: 'postCtrl',
                controllerAs: 'ctrl',
                templateUrl: './templates/home/home_tpl.html'
            })
            .state('post', {
                url: '/post/:id',
                views: {
                    post: {
                        controller: 'detailCtrl',
                        controllerAs: 'ctrl',
                        templateUrl: './templates/detail/post_detail_tpl.html'
                    },
                    comments: {
                        controller: 'commentsCtrl',
                        controllerAs: 'ctrl',
                        templateUrl: './templates/comments/comments_tpl.html'
                    }
                }
            });
        $locationProvider.html5Mode(false);
    } // End routes
    
    // Inyectando dependencias.
    removerCache.$inject = ['$rootScope', '$templateCache'];
    /**
     * @description Remueve el cache al detectar que un cambio de ruta comienza.
     * @param $rootScope
     * @param $templateCache
     */
    function removerCache($rootScope, $templateCache) {
        $rootScope.$on('$routeChangeStart', function (event, next, current) {
            if (typeof (current) !== 'undefined') {
                $templateCache.remove(current.templateUrl);
            }
        });
    } // End removerCache

})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNmYXBwLm1vZHVsZS5qcyIsImNmYXBwLnNlcnZpY2VzLmpzIiwiY2ZhcHAuY29udHJvbGxlci5qcyIsImNmYXBwLnJvdXRlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLWxpYnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjZmFwcCcsIFsndWkucm91dGVyJywnbmdSZXNvdXJjZScsJ2FwaVJlc3QnXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBpUmVzdCcsIFtdKVxuICAgICAgICAuZmFjdG9yeSgnR2V0UG9zdEZhY3RvcnknLCBHZXRQb3N0U2VydmljZSlcbiAgICAgICAgLmZhY3RvcnkoJ0dldFBvc3REZXRhaWxGYWN0b3J5JywgR2V0UG9zdERldGFpbFNlcnZpY2UpXG4gICAgICAgIC5mYWN0b3J5KCdHZXRDb21tZW50c0ZhY3RvcnknLCBHZXRDb21tZW50c1NlcnZpY2UpO1xuXG4gICAgR2V0UG9zdFNlcnZpY2UuJGluamVjdG9yID0gWyckcmVzb3VyY2UnXTtcbiAgICBHZXRQb3N0RGV0YWlsU2VydmljZS4kaW5qZWN0b3IgPSBbJyRyZXNvdXJjZSddO1xuICAgIEdldENvbW1lbnRzU2VydmljZS4kaW5qZWN0b3IgPSBbJyRyZXNvdXJjZSddO1xuXG4gICAgZnVuY3Rpb24gR2V0UG9zdFNlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzJyk7XG4gICAgfVxuICAgIC8vIERldGFsbGVzIGRlIGxhIHB1YmxpY2FjaW9uXG4gICAgZnVuY3Rpb24gR2V0UG9zdERldGFpbFNlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzppZCcsIHtcbiAgICAgICAgICAgIGlkOiAnQGlkJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ29tZW50YXJpb3MgZGUgbGEgcHVibGljYWNpb25cbiAgICBmdW5jdGlvbiBHZXRDb21tZW50c1NlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzppZC9jb21tZW50cycsIHtcbiAgICAgICAgICAgIGlkOiAnQGlkJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnY2ZhcHAnKVxuICAgICAgICAuY29udHJvbGxlcigncG9zdEN0cmwnLCBQb3N0KVxuICAgICAgICAuY29udHJvbGxlcignZGV0YWlsQ3RybCcsIERldGFpbClcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2NvbW1lbnRzQ3RybCcsIENvbW1lbnRzKTtcblxuICAgIFBvc3QuJGluamVjdCA9IFsnR2V0UG9zdEZhY3RvcnknXTtcbiAgICBEZXRhaWwuJGluamVjdCA9IFsnR2V0UG9zdERldGFpbEZhY3RvcnknLCAnJHN0YXRlUGFyYW1zJ107XG4gICAgQ29tbWVudHMuJGluamVjdCA9IFsnR2V0Q29tbWVudHNGYWN0b3J5JywgJyRzdGF0ZVBhcmFtcyddO1xuXG4gICAgZnVuY3Rpb24gUG9zdChHZXRQb3N0RmFjdG9yeSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5lbnRyaWVzID0gW107XG4gICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBleGVjdXRlKCk7XG4gICAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE9idGVuZXJQb3N0KCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gT2J0ZW5lclBvc3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gR2V0UG9zdEZhY3RvcnkucXVlcnkoZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5lbnRyaWVzID0gZGF0YTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgIHZtLmVudHJpZXM7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTsgLy8gcmVncmVzYSB0b2RhcyBsYXMgcHVibGljYWNpb25lc1xuICAgICAgICB9XG4gICAgfSAvLyBFbmQgUG9zdFxuXG4gICAgZnVuY3Rpb24gRGV0YWlsKEdldFBvc3REZXRhaWxTZXJ2aWNlLCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uZW50cnk7XG4gICAgICAgIHZtLmlkID0gJHN0YXRlUGFyYW1zLmlkO1xuICAgICAgICB2bS5sb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgZXhlY3V0ZSgpO1xuICAgICAgICBmdW5jdGlvbiBleGVjdXRlKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBPYnRlbmVyUG9zdERldGFsbGUoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBPYnRlbmVyUG9zdERldGFsbGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gR2V0UG9zdERldGFpbFNlcnZpY2UuZ2V0KHsgaWQ6IHZtLmlkIH0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uZW50cnkgPSBkYXRhO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgdm0uZW50cnk7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTsgLy8gcmVncmVzYSBjb250ZW5pZG8gZGVsIHBvc3RcbiAgICAgICAgfVxuICAgIH0gLy8gRW5kIERldGFpbFxuXG4gICAgZnVuY3Rpb24gQ29tbWVudHMoR2V0Q29tbWVudHNGYWN0b3J5LCAkc3RhdGVQYXJhbXMpIHtcbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0uY29tbWVudDtcbiAgICAgICAgdm0uaWQgPSAkc3RhdGVQYXJhbXMuaWQ7XG4gICAgICAgIHZtLmxvYWRpbmcgPSB0cnVlO1xuICAgICAgICBleGVjdXRlKCk7XG4gICAgICAgIGZ1bmN0aW9uIGV4ZWN1dGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE9idGVuZXJDb21lbnRhcmlvcygpO1xuICAgICAgICB9XG4gICAgICAgIGZ1bmN0aW9uIE9idGVuZXJDb21lbnRhcmlvcygpIHtcbiAgICAgICAgICAgIHJldHVybiBHZXRDb21tZW50c0ZhY3RvcnkucXVlcnkoeyBpZDogdm0uaWQgfSwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2bS5jb21tZW50ID0gZGF0YTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgIHZtLmNvbW1lbnQ7XG4gICAgICAgICAgICAgICAgdm0ubG9hZGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2bS5sb2FkaW5nID0gZmFsc2U7XG4gICAgICAgICAgICB9KTsgLy8gcmVncmVzYSBsb3MgY29tZW50YXJpb3MgcmVsYWNpb25hZG9zIGFsIHBvc3RcbiAgICAgICAgfVxuXG4gICAgfSAvLyBFbmQgQ29tbWVudHNcblxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2NmYXBwJylcbiAgICAgICAgLmNvbmZpZyhyb3V0ZXMpXG4gICAgICAgIC5ydW4ocmVtb3ZlckNhY2hlKTtcblxuICAgIC8vIElueWVjdGFuZG8gZGVwZW5kZW5jaWFzLlxuICAgIHJvdXRlcy4kaW5qZWN0ID0gWyckc3RhdGVQcm92aWRlcicsICckdXJsUm91dGVyUHJvdmlkZXInLCAnJGxvY2F0aW9uUHJvdmlkZXInXTtcbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gZ2VzdGlvbmEgbGFzIHJ1dGFzIGRlIGxhIGFwbGljYWNpw7NuLlxuICAgICAqIEBwYXJhbSAkc3RhdGVQcm92aWRlclxuICAgICAqIEBwYXJhbSAkdXJsUm91dGVyUHJvdmlkZXJcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgJGxvY2F0aW9uUHJvdmlkZXIpIHtcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdob21lJywge1xuICAgICAgICAgICAgICAgIHVybDogJy8nLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdwb3N0Q3RybCcsXG4gICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnY3RybCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy9ob21lL2hvbWVfdHBsLmh0bWwnXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdwb3N0Jywge1xuICAgICAgICAgICAgICAgIHVybDogJy9wb3N0LzppZCcsXG4gICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgcG9zdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2RldGFpbEN0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnY3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vdGVtcGxhdGVzL2RldGFpbC9wb3N0X2RldGFpbF90cGwuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjb21tZW50c0N0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAnY3RybCcsXG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vdGVtcGxhdGVzL2NvbW1lbnRzL2NvbW1lbnRzX3RwbC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZShmYWxzZSk7XG4gICAgfSAvLyBFbmQgcm91dGVzXG4gICAgXG4gICAgLy8gSW55ZWN0YW5kbyBkZXBlbmRlbmNpYXMuXG4gICAgcmVtb3ZlckNhY2hlLiRpbmplY3QgPSBbJyRyb290U2NvcGUnLCAnJHRlbXBsYXRlQ2FjaGUnXTtcbiAgICAvKipcbiAgICAgKiBAZGVzY3JpcHRpb24gUmVtdWV2ZSBlbCBjYWNoZSBhbCBkZXRlY3RhciBxdWUgdW4gY2FtYmlvIGRlIHJ1dGEgY29taWVuemEuXG4gICAgICogQHBhcmFtICRyb290U2NvcGVcbiAgICAgKiBAcGFyYW0gJHRlbXBsYXRlQ2FjaGVcbiAgICAgKi9cbiAgICBmdW5jdGlvbiByZW1vdmVyQ2FjaGUoJHJvb3RTY29wZSwgJHRlbXBsYXRlQ2FjaGUpIHtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0LCBjdXJyZW50KSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIChjdXJyZW50KSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAkdGVtcGxhdGVDYWNoZS5yZW1vdmUoY3VycmVudC50ZW1wbGF0ZVVybCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0gLy8gRW5kIHJlbW92ZXJDYWNoZVxuXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
