/**
 * angular-test - Prueba básica de AngularJS usando las guías de estilo de John Papa con JSONPlaceholder
 * @author Angel Cruz <me@abr4xas.org> (http://abr4xas.org)
 * @version v1.0.0
 * @link 
 */

(function () {
    'use strict';
    angular
        .module('cfapp', ['ui.router','ngResource','apiRest']);
})();
(function () {
    'use strict';
    angular
        .module('apiRest', [])
        .factory('GetPostFactory', GetPostService)
        .factory('GetPostDetailFactory', GetPostDetailService)
        .factory('GetCommentsFactory', GetCommentsService);

    GetPostService.$injector = ['$resource'];
    GetPostDetailService.$injector = ['$resource'];
    GetCommentsService.$injector = ['$resource'];

    function GetPostService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts');
    }
    // Detalles de la publicacion
    function GetPostDetailService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts/:id', {
            id: '@id'
        });
    }
    
    // Comentarios de la publicacion
    function GetCommentsService($resource) {
        return $resource('http://jsonplaceholder.typicode.com/posts/:id/comments', {
            id: '@id'
        });
    }
    
})();
(function () {
    'use strict';
    angular
        .module('cfapp')
        .controller('postCtrl', Post)
        .controller('detailCtrl', Detail)
        .controller('commentsCtrl', Comments);

    Post.$inject = ['GetPostFactory'];
    Detail.$inject = ['GetPostDetailFactory', '$stateParams'];
    Comments.$inject = ['GetCommentsFactory', '$stateParams'];

    function Post(GetPostFactory) {
        var vm = this;
        vm.entries = [];
        execute();
        function execute() {
            return new ObtenerPost();
        }
        function ObtenerPost() {
            return GetPostFactory.query(function (data) {
                vm.entries = data;
                //console.log(data);
                vm.entries;
            }); // regresa todas las publicaciones
        }
    } // End Post

    function Detail(GetPostDetailService, $stateParams) {
        var vm = this;
        vm.entry;
        vm.id = $stateParams.id;
        execute();
        function execute() {
            return new ObtenerPostDetalle();
        }
        function ObtenerPostDetalle() {
            return GetPostDetailService.get({ id: vm.id }, function (data) {
                vm.entry = data;
                //console.log(data);
                vm.entry;
            }); // regresa contenido del post
        }
    } // End Detail
    
    function Comments(GetCommentsFactory, $stateParams) {
        var vm = this;
        vm.comment;
        vm.id = $stateParams.id;
        execute();
        function execute() {
            return new ObtenerComentarios();
        }
        function ObtenerComentarios() {
            return GetCommentsFactory.query({ id: vm.id }, function (data) {
                vm.comment = data;
                //console.log(data);
                vm.comment;
            }); // regresa los comentarios relacionados al post
        }
        
    } // End Comments
    
})();
(function () {
    'use strict';
    angular
        .module('cfapp')
        .config(routes)
        .run(removerCache);

    // Inyectando dependencias.
    routes.$inject = ['$stateProvider', '$urlRouterProvider', '$locationProvider'];
    /**
     * @description gestiona las rutas de la aplicación.
     * @param $stateProvider
     * @param $urlRouterProvider
     */
    function routes($stateProvider, $urlRouterProvider, $locationProvider) {
        $urlRouterProvider.otherwise('/');
        $stateProvider
            .state('home', {
                url: '/',
                controller: 'postCtrl',
                controllerAs: 'ctrl',
                templateUrl: './templates/home/home_tpl.html'
            })
            .state('post', {
                url: '/post/:id',
                views: {
                    post: {
                        controller: 'detailCtrl',
                        controllerAs: 'ctrl',
                        templateUrl: './templates/detail/post_detail_tpl.html'
                    },
                    comments: {
                        controller: 'commentsCtrl',
                        controllerAs: 'ctrl',
                        templateUrl: './templates/comments/comments_tpl.html'
                    }
                }
            });
        $locationProvider.html5Mode(false);
    } // End routes
    
    // Inyectando dependencias.
    removerCache.$inject = ['$rootScope', '$templateCache'];
    /**
     * @description Remueve el cache al detectar que un cambio de ruta comienza.
     * @param $rootScope
     * @param $templateCache
     */
    function removerCache($rootScope, $templateCache) {
        $rootScope.$on('$routeChangeStart', function (event, next, current) {
            if (typeof (current) !== 'undefined') {
                $templateCache.remove(current.templateUrl);
            }
        });
    } // End removerCache

})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNmYXBwLm1vZHVsZS5qcyIsImNmYXBwLnNlcnZpY2VzLmpzIiwiY2ZhcHAuY29udHJvbGxlci5qcyIsImNmYXBwLnJvdXRlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLWxpYnMubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjZmFwcCcsIFsndWkucm91dGVyJywnbmdSZXNvdXJjZScsJ2FwaVJlc3QnXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBpUmVzdCcsIFtdKVxuICAgICAgICAuZmFjdG9yeSgnR2V0UG9zdEZhY3RvcnknLCBHZXRQb3N0U2VydmljZSlcbiAgICAgICAgLmZhY3RvcnkoJ0dldFBvc3REZXRhaWxGYWN0b3J5JywgR2V0UG9zdERldGFpbFNlcnZpY2UpXG4gICAgICAgIC5mYWN0b3J5KCdHZXRDb21tZW50c0ZhY3RvcnknLCBHZXRDb21tZW50c1NlcnZpY2UpO1xuXG4gICAgR2V0UG9zdFNlcnZpY2UuJGluamVjdG9yID0gWyckcmVzb3VyY2UnXTtcbiAgICBHZXRQb3N0RGV0YWlsU2VydmljZS4kaW5qZWN0b3IgPSBbJyRyZXNvdXJjZSddO1xuICAgIEdldENvbW1lbnRzU2VydmljZS4kaW5qZWN0b3IgPSBbJyRyZXNvdXJjZSddO1xuXG4gICAgZnVuY3Rpb24gR2V0UG9zdFNlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzJyk7XG4gICAgfVxuICAgIC8vIERldGFsbGVzIGRlIGxhIHB1YmxpY2FjaW9uXG4gICAgZnVuY3Rpb24gR2V0UG9zdERldGFpbFNlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzppZCcsIHtcbiAgICAgICAgICAgIGlkOiAnQGlkJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ29tZW50YXJpb3MgZGUgbGEgcHVibGljYWNpb25cbiAgICBmdW5jdGlvbiBHZXRDb21tZW50c1NlcnZpY2UoJHJlc291cmNlKSB7XG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJ2h0dHA6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3Bvc3RzLzppZC9jb21tZW50cycsIHtcbiAgICAgICAgICAgIGlkOiAnQGlkJ1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnY2ZhcHAnKVxuICAgICAgICAuY29udHJvbGxlcigncG9zdEN0cmwnLCBQb3N0KVxuICAgICAgICAuY29udHJvbGxlcignZGV0YWlsQ3RybCcsIERldGFpbClcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2NvbW1lbnRzQ3RybCcsIENvbW1lbnRzKTtcblxuICAgIFBvc3QuJGluamVjdCA9IFsnR2V0UG9zdEZhY3RvcnknXTtcbiAgICBEZXRhaWwuJGluamVjdCA9IFsnR2V0UG9zdERldGFpbEZhY3RvcnknLCAnJHN0YXRlUGFyYW1zJ107XG4gICAgQ29tbWVudHMuJGluamVjdCA9IFsnR2V0Q29tbWVudHNGYWN0b3J5JywgJyRzdGF0ZVBhcmFtcyddO1xuXG4gICAgZnVuY3Rpb24gUG9zdChHZXRQb3N0RmFjdG9yeSkge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5lbnRyaWVzID0gW107XG4gICAgICAgIGV4ZWN1dGUoKTtcbiAgICAgICAgZnVuY3Rpb24gZXhlY3V0ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgT2J0ZW5lclBvc3QoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBPYnRlbmVyUG9zdCgpIHtcbiAgICAgICAgICAgIHJldHVybiBHZXRQb3N0RmFjdG9yeS5xdWVyeShmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmVudHJpZXMgPSBkYXRhO1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coZGF0YSk7XG4gICAgICAgICAgICAgICAgdm0uZW50cmllcztcbiAgICAgICAgICAgIH0pOyAvLyByZWdyZXNhIHRvZGFzIGxhcyBwdWJsaWNhY2lvbmVzXG4gICAgICAgIH1cbiAgICB9IC8vIEVuZCBQb3N0XG5cbiAgICBmdW5jdGlvbiBEZXRhaWwoR2V0UG9zdERldGFpbFNlcnZpY2UsICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5lbnRyeTtcbiAgICAgICAgdm0uaWQgPSAkc3RhdGVQYXJhbXMuaWQ7XG4gICAgICAgIGV4ZWN1dGUoKTtcbiAgICAgICAgZnVuY3Rpb24gZXhlY3V0ZSgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgT2J0ZW5lclBvc3REZXRhbGxlKCk7XG4gICAgICAgIH1cbiAgICAgICAgZnVuY3Rpb24gT2J0ZW5lclBvc3REZXRhbGxlKCkge1xuICAgICAgICAgICAgcmV0dXJuIEdldFBvc3REZXRhaWxTZXJ2aWNlLmdldCh7IGlkOiB2bS5pZCB9LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgICAgIHZtLmVudHJ5ID0gZGF0YTtcbiAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgICAgIHZtLmVudHJ5O1xuICAgICAgICAgICAgfSk7IC8vIHJlZ3Jlc2EgY29udGVuaWRvIGRlbCBwb3N0XG4gICAgICAgIH1cbiAgICB9IC8vIEVuZCBEZXRhaWxcbiAgICBcbiAgICBmdW5jdGlvbiBDb21tZW50cyhHZXRDb21tZW50c0ZhY3RvcnksICRzdGF0ZVBhcmFtcykge1xuICAgICAgICB2YXIgdm0gPSB0aGlzO1xuICAgICAgICB2bS5jb21tZW50O1xuICAgICAgICB2bS5pZCA9ICRzdGF0ZVBhcmFtcy5pZDtcbiAgICAgICAgZXhlY3V0ZSgpO1xuICAgICAgICBmdW5jdGlvbiBleGVjdXRlKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBPYnRlbmVyQ29tZW50YXJpb3MoKTtcbiAgICAgICAgfVxuICAgICAgICBmdW5jdGlvbiBPYnRlbmVyQ29tZW50YXJpb3MoKSB7XG4gICAgICAgICAgICByZXR1cm4gR2V0Q29tbWVudHNGYWN0b3J5LnF1ZXJ5KHsgaWQ6IHZtLmlkIH0sIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICAgICAgdm0uY29tbWVudCA9IGRhdGE7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhkYXRhKTtcbiAgICAgICAgICAgICAgICB2bS5jb21tZW50O1xuICAgICAgICAgICAgfSk7IC8vIHJlZ3Jlc2EgbG9zIGNvbWVudGFyaW9zIHJlbGFjaW9uYWRvcyBhbCBwb3N0XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSAvLyBFbmQgQ29tbWVudHNcbiAgICBcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdjZmFwcCcpXG4gICAgICAgIC5jb25maWcocm91dGVzKVxuICAgICAgICAucnVuKHJlbW92ZXJDYWNoZSk7XG5cbiAgICAvLyBJbnllY3RhbmRvIGRlcGVuZGVuY2lhcy5cbiAgICByb3V0ZXMuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJywgJyRsb2NhdGlvblByb3ZpZGVyJ107XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIGdlc3Rpb25hIGxhcyBydXRhcyBkZSBsYSBhcGxpY2FjacOzbi5cbiAgICAgKiBAcGFyYW0gJHN0YXRlUHJvdmlkZXJcbiAgICAgKiBAcGFyYW0gJHVybFJvdXRlclByb3ZpZGVyXG4gICAgICovXG4gICAgZnVuY3Rpb24gcm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIsICRsb2NhdGlvblByb3ZpZGVyKSB7XG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcbiAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncG9zdEN0cmwnLFxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi90ZW1wbGF0ZXMvaG9tZS9ob21lX3RwbC5odG1sJ1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgncG9zdCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvcG9zdC86aWQnLFxuICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgIHBvc3Q6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdkZXRhaWxDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy9kZXRhaWwvcG9zdF9kZXRhaWxfdHBsLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGNvbW1lbnRzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnY29tbWVudHNDdHJsJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ2N0cmwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuL3RlbXBsYXRlcy9jb21tZW50cy9jb21tZW50c190cGwuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUoZmFsc2UpO1xuICAgIH0gLy8gRW5kIHJvdXRlc1xuICAgIFxuICAgIC8vIElueWVjdGFuZG8gZGVwZW5kZW5jaWFzLlxuICAgIHJlbW92ZXJDYWNoZS4kaW5qZWN0ID0gWyckcm9vdFNjb3BlJywgJyR0ZW1wbGF0ZUNhY2hlJ107XG4gICAgLyoqXG4gICAgICogQGRlc2NyaXB0aW9uIFJlbXVldmUgZWwgY2FjaGUgYWwgZGV0ZWN0YXIgcXVlIHVuIGNhbWJpbyBkZSBydXRhIGNvbWllbnphLlxuICAgICAqIEBwYXJhbSAkcm9vdFNjb3BlXG4gICAgICogQHBhcmFtICR0ZW1wbGF0ZUNhY2hlXG4gICAgICovXG4gICAgZnVuY3Rpb24gcmVtb3ZlckNhY2hlKCRyb290U2NvcGUsICR0ZW1wbGF0ZUNhY2hlKSB7XG4gICAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldmVudCwgbmV4dCwgY3VycmVudCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAoY3VycmVudCkgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgJHRlbXBsYXRlQ2FjaGUucmVtb3ZlKGN1cnJlbnQudGVtcGxhdGVVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9IC8vIEVuZCByZW1vdmVyQ2FjaGVcblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
